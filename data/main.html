<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" crossorigin="anonymous">
    <title>Youtube dashboard</title>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" crossorigin="anonymous"></script>
</head>

<body>
    <form id="config">
        <div class="form-group">
            <label for="AccountKey">AccountKey</label>
            <input id="AccountKey" required type="text" class="form-control" name="AccountKey" placeholder="AccountKey">
        </div>

        <div class="form-group">
            <label for="BusStopCode">BusStopCode</label>
            <input id="BusStopCode" required type="text" class="form-control" name="BusStopCode" placeholder="BusStopCode">
        </div>

        <button type="submit" class="btn btn-primary">Update config</button>
    </form>

    <button id="reset" type="button" class="btn btn-danger">Clear config</button>
    <button id="reboot" type="button" class="btn btn-danger">Reboot</button>

    <script>
        var hiddenClass = "d-none";
        var intiConfigForm = function (config) {
            $("#config").removeClass(hiddenClass);
            $("#config input").each(function (idx, el) {
                var $el = $(el);
                var name = $el.attr("name");
                $el.val(config[name]);
            });
        };

        var init = function () {
            $.get("/config", intiConfigForm);
        };


        var onConfigSubmit = function (e) {
            e.preventDefault();
            $.ajax({
                type: "POST",
                url: "/config",
                data: $(this).serialize(),
                success: init
            });
        };

        var reboot = function () {
            $.ajax({
                type: "POST",
                url: "/reboot"
            });
        };

        var reset = function () {
            $.ajax({
                type: "DELETE",
                url: "/config"
            });
        };

        $(function () {
            init();
            $("body").on("submit", "#config", onConfigSubmit);
            $('body').on("click", "#reboot", reboot);
            $('body').on("click", "#reset", reset);

        });
    </script>
</body>

</html>